# Load data frames
houseA <- read.csv('./data/rdata/houseA.csv')
houseB <- read.csv('./data/rdata/houseB.csv')
# Renaming the activities into the columns P1 and P2 of HouseA
houseA <- mutate(houseA,P1=as.factor(X21))
houseA <- mutate(houseA,P2=as.factor(X22))
houseA.head()
houseA.head
head(houseA)
houseA.actnames <- c(
"1"	= "Other",
"2" = "	Going_Out",
"3" =	"Preparing_Breakfast",
"4" =	"Having_Breakfast",
"5" =	"Preparing_Lunch",
"6" =	"Having_Lunch",
"7" =	"Preparing_Dinner",
"8" =	"Having_Dinner",
"9" =	"Washing_Dishes",
"10" =	"Having_Snack",
"11" =	"Sleeping",
"12" =	"Watching_TV",
"13" =	"Studying",
"14" =	"Having_Shower",
"15" =	"Toileting",
"16" =	"Napping",
"17" =	"Using_Internet",
"18" =	"Reading_Book",
"19" =	"Laundry",
"20" =	"Shaving",
"21" =	"Brushing_Teeth",
"22" =	"Talking_on_the_Phone",
"23" =	"Listening_to_Music",
"24" =	"Cleaning",
"25" =	"Having_Conversation",
"26" =	"Having_Guest",
"27" =	"Changing_Clothes")
houseA$P1 <- revalue(houseA$P1, houseA.actnames)
houseA$P2 <- revalue(houseA$P2, houseA.actnames)
# Renaming the columns names
names(houseA) <- c(
'Ph1',
'Ph2',
'Ir1',
'Fo1',
'Fo2',
'Di3',
'Di4',
'Ph3',
'Ph4',
'Ph5',
'Ph6',
'Co1',
'Co2',
'Co3',
'So1',
'So2',
'Di1',
'Di2',
'Te1',
'Fo3',
'X21',
'X22',
'P1',
'P2')
# Renaming the activities into the columns P1 and P2 of HouseB
houseB <- mutate(houseB,P1=as.factor(X21))
houseB <- mutate(houseB,P2=as.factor(X22))
houseB.actnames <- c(
"1" =	"Other",
"2" =	"Going Out",
"3" =	"Preparing Breakfast",
"4" =	"Having Breakfast",
"5" =	"Preparing Lunch",
"6" =	"Having Lunch",
"7" =	"Preparing Dinner",
"8" =	"Having Dinner",
"9" =	"Washing Dishes",
"10" =	"Having Snack",
"11" =	"Sleeping",
"12" =	"Watching TV",
"13" =	"Studying",
"14" =	"Having Shower",
"15" =	"Toileting",
"16" =	"Napping",
"17" =	"Using Internet",
"18" =	"Reading Book",
"19" =	"Laundry",
"20" =	"Shaving",
"21" =	"Brushing Teeth",
"22" =	"Talking on the Phone",
"23" =	"Listening to Music",
"24" =	"Cleaning",
"25" =	"Having Conversation",
"26" =	"Having Guest",
"27" =	"Changing Clothes")
houseB$P1 <- revalue(houseB$P1, houseB.actnames)
houseB$P2 <- revalue(houseB$P2, houseB.actnames)
#
names(houseB) <- c(
'co1',
'co2',
'co3',
'co4',
'co5',
'co6',
'di2',
'fo1',
'fo2',
'fo3',
'ph1',
'ph2',
'pr1',
'pr2',
'pr3',
'pr4',
'pr5',
'so1',
'so2',
'so3',
'X21',
'X22',
'P1',
'P2')
# Loading data
houseA <- read.csv("../../rdata/houseA_.csv")
# Loading data
houseA <- read.csv("./data/rdata/houseA_.csv")
houseB <- read.csv("./data/rdata/houseB_.csv")
head(houseA)
# Vector time for a day
day <- format( seq.POSIXt(as.POSIXct(Sys.Date()), as.POSIXct(Sys.Date()+1), by = "1 s"),
"%H:%M:%S", tz="GMT")
day <- day[-length(day)]
# Inserting time column
library(tibble)
houseA <- add_column(houseA, "time"=rep(day, 30) ,.before="Ph1")
houseB <- add_column(houseB, "time"=rep(day, 30) ,.before="co1")
head(houseA) ; head(houseB)
View(table(houseB$P1, houseB$P2))
# Pie Charts
freq_table_HA_R1 <- read.csv('./data/rdata/Freq_houseA_P1.csv')
freq_table_HA_R1
names(freq_table_HA_R1)[2] <- "Missing Activity"
freq_table_HA_R1
# Pie Charts
freq_table_HA_R1 <- read.csv('./data/rdata/Freq_houseA_P1.csv')
freq_table_HA_R1
names(freq_table_HA_R1)[2,2] <- "Missing Activity"
freq_table_HA_R1[2,2] <- "Missing Activity"
freq_table_HA_R1
freq_table_HA_R1 <- read.csv('./data/rdata/Freq_houseA_P1.csv')
freq_table_HA_R1[1,2] <- "Going_Out"
freq_table_HA_R1[2,2] <- "Missing_Activity"
freq_table_HA_R1
freq_table_HA_R2 <- read.csv('./data/rdata/Freq_houseA_P2.csv')
freq_table_HA_R2
freq_table_HB_R1 <- read.csv('./data/rdata/Freq_houseB_P1.csv')
freq_table_HB_R1
freq_table_HB_R2 <- read.csv('./data/rdata/Freq_houseB_P2.csv')
freq_table_HB_R2
freq_table_HB_R2[1,2] <- "Missing Activity"
freq_table_HA_R1 <- read.csv('./data/rdata/Freq_houseA_P1.csv')
freq_table_HA_R1[1,2] <- "Going_Out"
freq_table_HA_R1[2,2] <- "Missing_Activity"
freq_table_HA_R2 <- read.csv('./data/rdata/Freq_houseA_P2.csv')
freq_table_HA_R2[1,2] <- "Going_Out"
freq_table_HA_R2[2,2] <- "Missing_Activity"
freq_table_HB_R1 <- read.csv('./data/rdata/Freq_houseB_P1.csv')
freq_table_HB_R1[1,2] <- "Missing Activity"
freq_table_HB_R2 <- read.csv('./data/rdata/Freq_houseB_P2.csv')
freq_table_HB_R2[1,2] <- "Missing Activity"
bp_HA_R1 <- ggplot(freq_table_HA_R1, aes(x = Freq, y = Var1, fill = group))+
geom_bar(width = 1, stat = "identity")
# Creation of pie charts
library(ggplot2)
bp_HA_R1 <- ggplot(freq_table_HA_R1, aes(x = Freq, y = Var1, fill = group))+
geom_bar(width = 1, stat = "identity")
bp_HA_R1
bp_HA_R1 <- ggplot(freq_table_HA_R1,
aes(x = "Proportion", y = Freq, fill = Var1))+
geom_bar(width = 1, stat = "identity")
bp_HA_R1
bp_HA_R1
bp_HA_R1 <- ggplot(freq_table_HA_R1,
aes(x = "Proportion", y = Freq, fill = Var1))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0)
bp_HA_R1
freq_table_HA_R1 <- read.csv('./data/rdata/Freq_houseA_P1.csv')
freq_table_HA_R1[1,2] <- "Going_Out"
freq_table_HA_R1[2,2] <- "Missing_Activity"
names(freq_table_HA_R1)[2] <- "Activity"
freq_table_HA_R2 <- read.csv('./data/rdata/Freq_houseA_P2.csv')
freq_table_HA_R2[1,2] <- "Going_Out"
freq_table_HA_R2[2,2] <- "Missing_Activity"
names(freq_table_HA_R2)[2] <- "Activity"
freq_table_HB_R1 <- read.csv('./data/rdata/Freq_houseB_P1.csv')
freq_table_HB_R1[1,2] <- "Missing Activity"
names(freq_table_HB_R1)[2] <- "Activity"
freq_table_HB_R2 <- read.csv('./data/rdata/Freq_houseB_P2.csv')
freq_table_HB_R2[1,2] <- "Missing Activity"
names(freq_table_HB_R2)[2] <- "Activity"
bp_HA_R1 <- ggplot(freq_table_HA_R1,
aes(x = "Proportion", y = Freq, fill = Var1))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0)
bp_HA_R1
bp_HA_R1 <- ggplot(freq_table_HA_R1,
aes(x = "Proportion", y = Freq, fill = Activity))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0)
bp_HA_R1
# Compute the position of labels
bp_HA_R1 <- bp_HA_R1 %>%
arrange(desc(Activity)) %>%
mutate(prop = Freq / sum(bp_HA_R1$Freq) * 100) %>%
mutate(ypos = cumsum(prop)- 0.5*prop )
# Compute the position of labels
freq_table_HA_R1 <- freq_table_HA_R1 %>%
arrange(desc(Activity)) %>%
mutate(prop = Freq / sum(freq_table_HA_R1$Freq) * 100) %>%
mutate(ypos = cumsum(prop)- 0.5*prop )
bp_HA_R1 <- ggplot(freq_table_HA_R1,
aes(x = "Proportion", y = Freq, fill = Activity))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0)+
theme_void()+
theme(legend.position = "none")+
geom_text(aes(y = ypos, label = Activity), color = "white", size=6)+
scale_fill_brewer(palette="Set1")
bp_HA_R1
bp_HA_R1 <- ggplot(freq_table_HA_R1,
aes(x = "Proportion", y = prop, fill = Activity))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0)+
theme_void()+
theme(legend.position = "none")+
geom_text(aes(y = ypos, label = Activity), color = "white", size=6)+
scale_fill_brewer(palette="Set1")
bp_HA_R1
freq_table_HA_R1 <- read.csv('./data/rdata/Freq_houseA_P1.csv')
freq_table_HA_R1[1,2] <- "Going_Out"
freq_table_HA_R1[2,2] <- "Missing_Activity"
names(freq_table_HA_R1)[2] <- "Activity"
freq_table_HA_R2 <- read.csv('./data/rdata/Freq_houseA_P2.csv')
freq_table_HA_R2[1,2] <- "Going_Out"
freq_table_HA_R2[2,2] <- "Missing_Activity"
names(freq_table_HA_R2)[2] <- "Activity"
freq_table_HB_R1 <- read.csv('./data/rdata/Freq_houseB_P1.csv')
freq_table_HB_R1[1,2] <- "Missing Activity"
names(freq_table_HB_R1)[2] <- "Activity"
freq_table_HB_R2 <- read.csv('./data/rdata/Freq_houseB_P2.csv')
freq_table_HB_R2[1,2] <- "Missing Activity"
names(freq_table_HB_R2)[2] <- "Activity"
# Sorting Frequencies
sort(freq_table_HA_R1)
View(freq_table_HA_R1)
?sort
freq_table_HA_R1[order(freq_table_HA_R1$Freq, decreasing = TRUE)]
freq_table_HA_R1[order(freq_table_HA_R1$Freq, decreasing = TRUE),]
freq_table_HA_R2[order(freq_table_HA_R2$Freq, decreasing = TRUE),]
freq_table_HB_R1[order(freq_table_HB_R1$Freq, decreasing = TRUE),]
freq_table_HB_R2[order(freq_table_HB_R2$Freq, decreasing = TRUE),]
pmas2 <- ggplot(data = freq_table_HA_R1, aes(x = Activity, y = Freq)) +
geom_col(aes(fill = Activity) , show.legend = FALSE) +
ggtitle(paste("Time spent on each activity")) +
coord_flip() +
geom_label(aes(label = paste(freq_table_HA_R1$Freq,
percent(freq_table_HA_R1$Freq/sum(freq_table_HA_R1$Freq)),
sep = "\n"),
y = -150, fill = Activity),
show.legend = FALSE,
size = 3, label.padding = unit(0.1, "lines")) +
expand_limits(y = -150) +
scale_fill_brewer(palette = "Set3", direction = -1)
pmas2
library(scales)
pmas2 <- ggplot(data = freq_table_HA_R1, aes(x = Activity, y = Freq)) +
geom_col(aes(fill = Activity) , show.legend = FALSE) +
ggtitle(paste("Time spent on each activity")) +
coord_flip() +
geom_label(aes(label = paste(freq_table_HA_R1$Freq,
percent(freq_table_HA_R1$Freq/sum(freq_table_HA_R1$Freq)),
sep = "\n"),
y = -150, fill = Activity),
show.legend = FALSE,
size = 3, label.padding = unit(0.1, "lines")) +
expand_limits(y = -150) +
scale_fill_brewer(palette = "Set3", direction = -1)
pmas2
pmas2 <- ggplot(data = freq_table_HA_R1, aes(x = Activity, y = Freq)) +
geom_col(aes(fill = Activity) , show.legend = FALSE) +
ggtitle(paste("Time spent on each activity")) +
coord_flip() +
geom_label(aes(label = percent(freq_table_HA_R1$Freq/sum(freq_table_HA_R1$Freq)), sep = "\n"),
y = -150, fill = Activity),
show.legend = FALSE,
size = 3, label.padding = unit(0.1, "lines")) +
expand_limits(y = -150) +
scale_fill_brewer(palette = "Set3", direction = -1)
pmas2 <- ggplot(data = freq_table_HA_R1, aes(x = Activity, y = Freq)) +
geom_col(aes(fill = Activity) , show.legend = FALSE) +
ggtitle(paste("Time spent on each activity")) +
coord_flip() +
geom_label(aes(label = percent(freq_table_HA_R1$Freq/sum(freq_table_HA_R1$Freq)),
y = -150, fill = Activity),
show.legend = FALSE,
size = 3, label.padding = unit(0.1, "lines")) +
expand_limits(y = -150) +
scale_fill_brewer(palette = "Set3", direction = -1)
pmas2
?percent
pmas2 <- ggplot(data = freq_table_HA_R1, aes(x = Activity, y = Freq)) +
geom_col(aes(fill = Activity) , show.legend = FALSE) +
ggtitle(paste("Time spent on each activity")) +
coord_flip() +
geom_label(aes(label = percent(freq_table_HA_R1$Freq/sum(freq_table_HA_R1$Freq), accuracy =  0.01),
y = -150, fill = Activity),
show.legend = FALSE,
size = 3, label.padding = unit(0.1, "lines")) +
expand_limits(y = -150) +
scale_fill_brewer(palette = "Set3", direction = -1)
pmas2
pmas2 <- ggplot(data = freq_table_HA_R1, aes(x = Activity, y = Freq)) +
geom_col(aes(fill = Activity) , show.legend = FALSE) +
ggtitle(paste("Time spent on each activity")) +
coord_flip() +
geom_label(aes(label = percent(Freq/sum(Freq), accuracy =  0.01),
y = -150, fill = Activity),
show.legend = FALSE,
size = 3, label.padding = unit(0.1, "lines")) +
expand_limits(y = -150) +
scale_fill_brewer(palette = "Set3", direction = -1)
pmas2
pmas2 <- ggplot(data = freq_table_HA_R1, aes(x = Activity, y = Freq)) +
geom_col(aes(fill = Activity) , show.legend = FALSE) +
ggtitle(paste("Time spent on each activity")) +
coord_flip() +
geom_label(aes(label = percent(Freq/sum(Freq), accuracy =  0.001),
y = -150, fill = Activity),
show.legend = FALSE,
size = 3, label.padding = unit(0.1, "lines")) +
expand_limits(y = -150) +
scale_fill_brewer(palette = "Set3", direction = -1)
pmas2
?scale_fill_brewer
pmas2 <- ggplot(data = freq_table_HA_R1, aes(x = Activity, y = Freq)) +
geom_col(aes(fill = Activity) , show.legend = FALSE) +
ggtitle(paste("Time spent on each activity")) +
coord_flip() +
geom_label(aes(label = percent(Freq/sum(Freq), accuracy =  0.001),
y = -150, fill = Activity),
show.legend = FALSE,
size = 3, label.padding = unit(0.1, "lines")) +
expand_limits(y = -150) +
scale_fill_brewer(palette = "Accent", direction = -1)
pmas2
pmas2 <- ggplot(data = freq_table_HA_R1, aes(x = Activity, y = Freq)) +
geom_col(aes(fill = Activity) , show.legend = FALSE) +
ggtitle(paste("Time spent on each activity")) +
coord_flip() +
geom_label(aes(label = percent(Freq/sum(Freq), accuracy =  0.001),
y = -150, fill = Activity),
show.legend = FALSE,
size = 3, label.padding = unit(0.1, "lines")) +
expand_limits(y = -150) +
scale_fill_brewer(palette = "Dark2", direction = -1)
pmas2
pmas2 <- ggplot(data = freq_table_HA_R1, aes(x = Activity, y = Freq)) +
geom_col(aes(fill = Activity) , show.legend = FALSE) +
ggtitle(paste("Time spent on each activity")) +
coord_flip() +
geom_label(aes(label = percent(Freq/sum(Freq), accuracy =  0.001),
y = -150, fill = Activity),
show.legend = FALSE,
size = 3, label.padding = unit(0.1, "lines")) +
expand_limits(y = -150) +
scale_fill_brewer(palette = "Spectral", direction = -1)
pmas2
pmas2 <- ggplot(data = freq_table_HA_R1, aes(x = Activity, y = Freq)) +
geom_col(aes(fill = Activity) , show.legend = FALSE) +
ggtitle(paste("Time spent on each activity")) +
coord_flip() +
geom_label(aes(label = percent(Freq/sum(Freq), accuracy =  0.001),
y = -150, fill = Activity),
show.legend = FALSE,
size = 3, label.padding = unit(0.1, "lines")) +
expand_limits(y = -150)
pmas2
?ggplot
# Sorting Frequencies
freq_table_HA_R1 <- freq_table_HA_R1[order(freq_table_HA_R1$Freq, decreasing = TRUE),]
pmas2 <- ggplot(data = freq_table_HA_R1, aes(x = Activity, y = Freq)) +
geom_col(aes(fill = Activity) , show.legend = FALSE) +
ggtitle(paste("Time spent on each activity")) +
coord_flip() +
geom_label(aes(label = percent(Freq/sum(Freq), accuracy =  0.001),
y = -150, fill = Activity),
show.legend = FALSE,
size = 3, label.padding = unit(0.1, "lines")) +
expand_limits(y = -150)
pmas2
freq_table_HA_R1
pmas2 <- ggplot(data = freq_table_HA_R1, aes(x = reorder(Activity, -Freq), y = Freq)) +
geom_col(aes(fill = Activity) , show.legend = FALSE) +
ggtitle(paste("Time spent on each activity")) +
coord_flip() +
geom_label(aes(label = percent(Freq/sum(Freq), accuracy =  0.001),
y = -150, fill = Activity),
show.legend = FALSE,
size = 3, label.padding = unit(0.1, "lines")) +
expand_limits(y = -150)
pmas2
pmas2 <- ggplot(data = freq_table_HA_R1, aes(x = reorder(Activity, Freq), y = Freq)) +
geom_col(aes(fill = Activity) , show.legend = FALSE) +
ggtitle(paste("Time spent on each activity")) +
coord_flip() +
geom_label(aes(label = percent(Freq/sum(Freq), accuracy =  0.001),
y = -150, fill = Activity),
show.legend = FALSE,
size = 3, label.padding = unit(0.1, "lines")) +
expand_limits(y = -150)
pmas2
pmas2 <- ggplot(data = freq_table_HA_R1, aes(x = reorder(Activity, Freq), y = Freq)) +
geom_col(aes(fill = Activity) , show.legend = FALSE) +
ggtitle(paste("Time spent on each activity")) +
coord_flip() +
geom_label(aes(label = percent(Freq/sum(Freq), accuracy =  0.001),
y = -150, fill = Activity),
show.legend = FALSE,
size = 3, label.padding = unit(0.1, "lines")) +
expand_limits(y = -150)+
labs(x = "Seconds")
pmas2
pmas2 <- ggplot(data = freq_table_HA_R1, aes(x = reorder(Activity, Freq), y = Freq)) +
geom_col(aes(fill = Activity) , show.legend = FALSE) +
ggtitle(paste("Time spent on each activity")) +
coord_flip() +
geom_label(aes(label = percent(Freq/sum(Freq), accuracy =  0.001),
y = -150, fill = Activity),
show.legend = FALSE,
size = 3, label.padding = unit(0.1, "lines")) +
expand_limits(y = -150)+
labs(x = "Activity", y = "Seconds")
pmas2
pmas2 <- ggplot(data = freq_table_HA_R1, aes(x = reorder(Activity, Freq), y = Freq)) +
geom_col(aes(fill = Activity) , show.legend = FALSE) +
ggtitle(paste("Time spent on each activity")) +
coord_flip() +
geom_label(aes(label = percent(Freq/sum(Freq), accuracy =  0.001),
y = -150, fill = Activity),
show.legend = FALSE,
size = 5, label.padding = unit(0.1, "lines")) +
expand_limits(y = -150)+
labs(x = "Activity", y = "Seconds")
pmas2
pmas2 <- ggplot(data = freq_table_HA_R1, aes(x = reorder(Activity, Freq), y = Freq)) +
geom_col(aes(fill = Activity) , show.legend = FALSE) +
ggtitle(paste("Time spent on each activity")) +
coord_flip() +
geom_label(aes(label = percent(Freq/sum(Freq), accuracy =  0.001),
y = -150, fill = Activity),
show.legend = FALSE,
size = 3.5, label.padding = unit(0.1, "lines")) +
expand_limits(y = -150)+
labs(x = "Activity", y = "Seconds")
pmas2
bar_HA_R2 <- ggplot(data = freq_table_HA_R2, aes(x = reorder(Activity, Freq), y = Freq)) +
geom_col(aes(fill = Activity) , show.legend = FALSE) +
ggtitle(paste("Time spent on each activity by resident 2 in house A")) +
coord_flip() +
geom_label(aes(label = percent(Freq/sum(Freq), accuracy =  0.001),
y = -150, fill = Activity),
show.legend = FALSE,
size = 3.5, label.padding = unit(0.1, "lines")) +
expand_limits(y = -150)+
labs(x = "Activity", y = "Seconds")
bar_HB_R1 <- ggplot(data = freq_table_HB_R1, aes(x = reorder(Activity, Freq), y = Freq)) +
geom_col(aes(fill = Activity) , show.legend = FALSE) +
ggtitle(paste("Time spent on each activity by resident 1 in house B")) +
coord_flip() +
geom_label(aes(label = percent(Freq/sum(Freq), accuracy =  0.001),
y = -150, fill = Activity),
show.legend = FALSE,
size = 3.5, label.padding = unit(0.1, "lines")) +
expand_limits(y = -150)+
labs(x = "Activity", y = "Seconds")
bar_HB_R2 <- ggplot(data = freq_table_HB_R2, aes(x = reorder(Activity, Freq), y = Freq)) +
geom_col(aes(fill = Activity) , show.legend = FALSE) +
ggtitle(paste("Time spent on each activity by resident 2 in house B")) +
coord_flip() +
geom_label(aes(label = percent(Freq/sum(Freq), accuracy =  0.001),
y = -150, fill = Activity),
show.legend = FALSE,
size = 3.5, label.padding = unit(0.1, "lines")) +
expand_limits(y = -150)+
labs(x = "Activity", y = "Seconds")
bar_HA_R1 <- ggplot(data = freq_table_HA_R1, aes(x = reorder(Activity, Freq), y = Freq)) +
geom_col(aes(fill = Activity) , show.legend = FALSE) +
ggtitle(paste("Time spent on each activity by resident 1 in house A")) +
coord_flip() +
geom_label(aes(label = percent(Freq/sum(Freq), accuracy =  0.001),
y = -150, fill = Activity),
show.legend = FALSE,
size = 3.5, label.padding = unit(0.1, "lines")) +
expand_limits(y = -150)+
labs(x = "Activity", y = "Seconds")
bar_HA_R1
bar_HA_R2
bar_HB_R1
bar_HB_R2
